var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function s(t){try{h(o.next(t))}catch(e){i(e)}}function a(t){try{h(o["throw"](t))}catch(e){i(e)}}function h(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,a)}h((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return h.label++,{value:n[1],done:!1};case 5:h.label++,i=n[1],n=[0];continue;case 7:n=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){h=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){h.label=n[1];break}if(6===n[0]&&h.label<s[1]){h.label=s[1],s=n;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(n);break}s[2]&&h.ops.pop(),h.trys.pop();continue}n=e.call(t,h)}catch(o){n=[6,o],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__assign=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;o>n;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},GameObject=function(){function t(){this.compornent=null,this.shapes=[],this.destroyFlag=!1,t.objects.push(this)}return t.init=function(e){t.objects=[],t.display=e},t.prototype.destroy=function(){this.destroyFlag=!0},t.prototype.addDestroyMethod=function(){},t.prototype["delete"]=function(){var e=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(t){e.compornent.removeChild(t),t=null}),this.shapes=[]),Util.remove(t.display,this.compornent);var n=t.objects.filter(function(t){return t.destroyFlag!==!0});t.objects=n},t.allDestroy=function(){t.objects=t.objects.filter(function(t){return t.destroy(),t["delete"](),!1})},t.update=function(){t.objects.forEach(function(t){return t.updateContent()}),t.objects=t.objects.filter(function(t){return t.destroyFlag&&t["delete"](),!t.destroyFlag}),t.transit&&(t.allDestroy(),t.transit(),t.transit=null)},t.objects=[],t}();__reflect(GameObject.prototype,"GameObject");var GameCompornent=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.setCompornent(e,n,o,r),i}return __extends(e,t),e.prototype.setCompornent=function(t,e,n,o){this.compornent=new egret.DisplayObjectContainer,this.compornent.x=t,this.compornent.y=e,this.compornent.width=n,this.compornent.height=o,GameStage.display.addChild(this.compornent)},e.prototype["delete"]=function(){var t=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(e){t.compornent.removeChild(e),e=null}),this.shapes=[]),this.compornent&&Util.remove(GameStage.display,this.compornent);var e=GameObject.objects.filter(function(t){return t.destroyFlag!==!0});GameObject.objects=e},e}(GameObject);__reflect(GameCompornent.prototype,"GameCompornent");var UICompornent=function(t){function e(e,n,o,r){var i=t.call(this)||this;return i.setCompornent(e,n,o,r),i}return __extends(e,t),e.prototype.setCompornent=function(t,e,n,o){this.compornent=new egret.DisplayObjectContainer,this.compornent.x=t,this.compornent.y=e,this.compornent.width=n,this.compornent.height=o,UILayer.display.addChild(this.compornent)},e.prototype["delete"]=function(){var t=this;this.addDestroyMethod(),this.shapes&&this.compornent&&(this.shapes.forEach(function(e){t.compornent.removeChild(e),e=null}),this.shapes=[]),this.compornent&&Util.remove(UILayer.display,this.compornent);var e=GameObject.objects.filter(function(t){return t.destroyFlag!==!0});GameObject.objects=e},e.compornents=[],e}(GameObject);__reflect(UICompornent.prototype,"UICompornent");var MyTween=function(){function t(){}return t.labelEffect=function(t,e,n){egret.Tween.get(e).to({y:n,alpha:1},300).to({y:2*n-e.y,alpha:0},300,egret.Ease.quadOut).call(function(){egret.Tween.removeTweens(e),t.destroy()})},t.textFlash=function(t){egret.Tween.get(t,{loop:!0}).to({alpha:1},700).to({alpha:0},700).to({alpha:1},700)},t.result=function(t,e){egret.Tween.get(e).wait(2e3).call(function(){egret.Tween.removeTweens(e),Result.roulette=!0,t.checkScore(),new RetryButton((Game.width-.4*Game.width)/2,.6*Game.height,.4*Game.width,.18*Game.width,80,.5,"リトライ")})},t.touchMissPanel=function(t,e){egret.Tween.get(t).to({scaleX:1.15,scaleY:1.15},50,egret.Ease.quartIn).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.removeTweens(t)}),egret.Tween.get(e).to({alpha:.3},50,egret.Ease.quartIn).to({alpha:0},100).call(function(){egret.Tween.removeTweens(e)})},t.touchCorrectPanel=function(t,e){egret.Tween.get(t).to({scaleX:1.15,scaleY:1.15},50,egret.Ease.quartIn).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.removeTweens(t)}),egret.Tween.get(e).to({alpha:.3},50,egret.Ease.quartIn).to({alpha:0},100).call(function(){egret.Tween.removeTweens(e),CreateGameScene.I.resetShape(),CreateGameScene.I.arrangePanel()})},t}();__reflect(MyTween.prototype,"MyTween");var Background=function(t){function e(){var n=t.call(this)||this;return n.color=ColorPallet.WHITE,e.I=n,n.setCompornent(0,0,Game.width,Game.height),n.setShape(0,0,Game.width,Game.height,n.color),n}return __extends(e,t),e.prototype.setCompornent=function(t,e,n,o){this.compornent=new egret.DisplayObjectContainer,this.compornent.x=t,this.compornent.y=e,this.compornent.width=n,this.compornent.height=o,GameObject.display.addChild(this.compornent)},e.prototype.setShape=function(t,e,n,o,r){var i=Util.setRect(t,e,n,o,r,0,!0);this.compornent.addChild(i),this.shapes.push(i)},e.prototype.updateContent=function(){},e.I=null,e}(GameObject);__reflect(Background.prototype,"Background");var Panel=function(t){function e(e,n,o,r,i){var s=t.call(this,e,n,o,r)||this;return s.correctFlag=!1,s.mask=null,s.setShape(0,0,o,r,i),s.setMask(0,0,o,r,16777215),s.compornent.once(egret.TouchEvent.TOUCH_BEGIN,s.touch,s),s.compornent.once(egret.TouchEvent.TOUCH_END,s.end,s),s}return __extends(e,t),e.prototype.setShape=function(t,e,n,o,r){var i=Util.setRect(t,e,n,o,r,30,!0);this.compornent.touchEnabled=!0,this.compornent.addChild(i),this.shapes.push(i),this.compornent.anchorOffsetX+=this.compornent.width/2,this.compornent.anchorOffsetY+=this.compornent.height/2},e.prototype.setMask=function(t,e,n,o,r){this.mask=Util.setRect(t,e,n,o,r,30,!0),this.compornent.addChild(this.mask),this.shapes.push(this.mask),this.mask.alpha=0},e.prototype.touch=function(){if(!GameOver.gameOverFlag)if(CreateGameScene.I.startFlag)this.correctFlag?(Score.addScore(),new EffectLabel(this.compornent.x,this.compornent.y,this.compornent.width,this.compornent.height,65280,Score.combo.toString()+" COMBO"),MyTween.touchCorrectPanel(this.compornent,this.mask),CreateGameScene.lightAndDark>10&&(CreateGameScene.lightAndDark-=1)):(Score.miss(),new EffectLabel(this.compornent.x,this.compornent.y,this.compornent.width,this.compornent.height,0,"MISS.."),MyTween.touchMissPanel(this.compornent,this.mask),CreateGameScene.lightAndDark=50);else if(this.correctFlag)return CreateGameScene.I.startFlag=!0,new TimeLimit(0,0,0,0,ColorPallet.BLACK),e.retryButton=new RetryButton(Game.width-.26*Game.width,.16*Game.width,.26*Game.width,.12*Game.width,60,.5,"リトライ"),Description.I.destroy(),CreateGameScene.I.resetShape(),void CreateGameScene.I.arrangePanel()},e.prototype.end=function(){this.mask.alpha=0},e.prototype.updateContent=function(){},e.retryButton=null,e}(GameCompornent);__reflect(Panel.prototype,"Panel");var ResultComment;!function(t){t[t.ELDERLY=0]="ELDERLY",t[t.DOG=1]="DOG",t[t.CAT=2]="CAT",t[t.TIGER=3]="TIGER",t[t.HAWK=4]="HAWK",t[t.PC=5]="PC"}(ResultComment||(ResultComment={}));var Result=function(t){function e(n,o,r,i,s){var a=t.call(this,n,o,r,i)||this;return a.text=null,a.textColor=0,a.score=0,a.resultComment=null,a.comentNumber=0,e.I=a,a.textColor=s,a.score=Score.score,e.roulette=!1,a.setText(),MyTween.result(a,a.text),a}return __extends(e,t),e.prototype.setText=function(){var t=this.resultComment;this.text=Util.myText(Game.width/2,.5*Game.height,t,120,.5,this.textColor,!0),this.text.anchorOffsetX=this.text.width/2,this.text.anchorOffsetY=this.text.height/2,this.compornent.addChild(this.text)},e.prototype.addDestroyMethod=function(){this.compornent&&this.compornent.removeChildren(),this.text=null},e.prototype.checkScore=function(){this.score>=0&&this.score<600?this.resultComment="老眼です":this.score>=600&&this.score<800?this.resultComment="やや老眼":this.score>=800&&this.score<1e3?this.resultComment="老眼ではありません":this.score>=1e3&&this.score<1200?this.resultComment="クリアな視界":this.score>=1200&&(this.resultComment="精密機械"),this.text.text=this.resultComment,this.text.anchorOffsetX=this.text.width/2,this.text.anchorOffsetY=this.text.height/2},e.prototype.changeComment=function(){if(!e.roulette){switch(this.comentNumber++,this.comentNumber>ResultComment.PC&&(this.comentNumber=0),this.comentNumber){case ResultComment.ELDERLY:this.resultComment="老眼です";break;case ResultComment.DOG:this.resultComment="やや老眼";break;case ResultComment.CAT:this.resultComment="老眼ではありません";break;case ResultComment.TIGER:this.resultComment="老眼ではありません";break;case ResultComment.HAWK:this.resultComment="クリアな視界";break;case ResultComment.PC:this.resultComment="精密機械"}this.text.text=this.resultComment,this.text.anchorOffsetX=this.text.width/2,this.text.anchorOffsetY=this.text.height/2}},e.prototype.updateContent=function(){this.changeComment()},e.I=null,e.roulette=!1,e}(UICompornent);__reflect(Result.prototype,"Result");var TimeLimit=function(t){function e(n,o,r,i,s){var a=t.call(this,n,o,r,i)||this;return a.coinCount=0,a.time=60,a.timeText=null,a.textColor=0,e.limitTimer=new egret.Timer(e.limitInterval,0),e.limitTimer.addEventListener(egret.TimerEvent.TIMER,a.timePass,a),e.limitTimer.start(),a.textColor=s,a.setText(),a}return __extends(e,t),e.startTimer=function(){e.limitTimer.start()},e.prototype.setText=function(){this.timeText=Util.myText(Game.width/2,0,"TIME : "+this.time.toString(),80,.5,this.textColor,!0),this.timeText.anchorOffsetX=this.timeText.width/2,this.compornent.addChild(this.timeText)},e.prototype.resetTimer=function(){e.limitTimer.stop(),e.limitTimer.removeEventListener(egret.TimerEvent.TIMER,this.timePass,this),e.limitTimer=new egret.Timer(e.limitInterval,0),e.limitTimer.addEventListener(egret.TimerEvent.TIMER,this.timePass,this),e.limitTimer.start()},e.prototype.timePass=function(){GameOver.gameOverFlag||(this.time>0&&(this.time-=1),0==this.time&&(this.time=0,new GameOver(0,0,0,0),Panel.retryButton.destroy()))},e.prototype.addDestroyMethod=function(){GameObject.display.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.timePass,this),e.limitTimer.stop(),e.limitTimer.removeEventListener(egret.TimerEvent.TIMER,this.timePass,this),this.compornent&&(this.compornent.removeChildren(),this.compornent=null),this.timeText=null},e.prototype.updateContent=function(){this.timeText.text="TIME : "+this.time.toString()},e.limitTimer=null,e.limitInterval=1e3,e}(UICompornent);__reflect(TimeLimit.prototype,"TimeLimit");var CreateGameScene=function(t){function e(){var n=t.call(this)||this;return n.boxColor=null,n.startFlag=!1,e.I=n,e.lightAndDark=50,n.startFlag=!1,n.arrangePanel(),n}return __extends(e,t),e.prototype.arrangePanel=function(){var t=Game.width/4.5,n=.3*Game.height,o=Util.randomInt(0,3),r=Util.randomInt(0,2),i=Util.randomInt(50,200),s=Util.randomInt(50,200),a=Util.randomInt(50,200);this.boxColor=Util.color(i,s,a);var h=Util.randomInt(0,1);h=0==h?1:-1;for(var l=Util.color(i+e.lightAndDark*h,s+e.lightAndDark*h,a+e.lightAndDark*h),c=0;4>c;c++){e.panel[c]=[];for(var p=0;3>p;p++)c==o&&p==r?(e.panel[c][p]=new Panel(200*p+t,200*c+n,180,180,l),e.panel[c][p].correctFlag=!0):e.panel[c][p]=new Panel(200*p+t,200*c+n,180,180,this.boxColor)}},e.prototype.resetShape=function(){for(var t=0;4>t;t++)for(var n=0;3>n;n++)e.panel[t][n].destroy();e.panel=[]},e.prototype.addDestroyMethod=function(){this.resetShape()},e.prototype.updateContent=function(){},e.I=null,e.lightAndDark=50,e.panel=[],e}(GameObject);__reflect(CreateGameScene.prototype,"CreateGameScene");var GameOver=function(t){function e(n,o,r,i){var s=t.call(this,n,o,r,i)||this;return s.textGameOver=null,s.textScore=null,s.textColor=ColorPallet.BLACK,e.I=s,e.gameOverFlag=!0,Score.I.gameOver(),s.setShape(),s.setText(),new Result(0,0,0,0,ColorPallet.BLACK),s}return __extends(e,t),e.prototype.setShape=function(){var t=Util.setRect(0,0,Game.width,Game.height,ColorPallet.WHITE,0,!0);this.compornent.addChild(t),t.alpha=.5,this.shapes.push(t)},e.prototype.setText=function(){this.textGameOver=Util.myText(Game.width/2,.4*Game.height,"あなたの目は…",80,.5,this.textColor,!0),this.textGameOver.anchorOffsetX=this.textGameOver.width/2,this.textGameOver.anchorOffsetY=this.textGameOver.height/2,this.compornent.addChild(this.textGameOver),this.textScore=Util.myText(Game.width/2,.2*Game.height+50,"",80,1,this.textColor,!0),this.textScore.anchorOffsetX=this.textScore.width/2,this.textScore.anchorOffsetY=this.textScore.height/2,this.compornent.addChild(this.textScore)},e.prototype.addDestroyMethod=function(){this.compornent&&this.compornent.removeChildren(),this.textGameOver=null,this.textScore=null,this.shapes=[]},e.prototype.updateContent=function(){},e.tap=function(){UILayer.I.remove(),GameObject.transit=Game.init},e.I=null,e.gameOverFlag=!1,e}(UICompornent);__reflect(GameOver.prototype,"GameOver");var ColorPallet;!function(t){t[t.WHITE=16777215]="WHITE",t[t.RED=15821679]="RED",t[t.BLUE=8437150]="BLUE",t[t.GREEN=9034329]="GREEN",t[t.VERMILION=16353382]="VERMILION",t[t.BLACK=2236962]="BLACK"}(ColorPallet||(ColorPallet={}));var Main=function(t){function e(){var n=t.call(this)||this;return e.I=n,n.once(egret.Event.ADDED_TO_STAGE,n.addToStage,n),n}return __extends(e,t),e.prototype.addToStage=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return Util.init(this),GameObject.init(this.stage),[4,Game.init()];case 1:return t.sent(),egret.startTick(this.tickLoop,this),[2]}})})},e.prototype.tickLoop=function(t){return GameObject.update(),!1},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Game=function(){function t(){}return t.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.width=egret.MainContext.instance.stage.stageWidth,this.height=egret.MainContext.instance.stage.stageHeight,this.mapChipWidth=this.width/9,this.mapChipHeight=this.height/16,GameOver.gameOverFlag=!1,new Background,new GameStage,new UILayer,new Score(0,0,0,0,ColorPallet.BLACK),new Description(0,0,0,0,ColorPallet.BLACK),[4,Social.init()];case 1:return t.sent(),new CreateGameScene,[2]}})})},t}();__reflect(Game.prototype,"Game");var EffectLabel=function(t){function e(e,n,o,r,i,s){var a=t.call(this,e,n,o,r)||this;return a.label=null,a.labelColor=0,a.text=null,a.labelColor=i,a.text=s,a.setText(0,0,o,r,s),MyTween.labelEffect(a,a.label,a.label.y-25),a}return __extends(e,t),e.prototype.setText=function(t,e,n,o,r){this.label=Util.myText(t,e,r,70,.5,this.labelColor,!0),this.label.alpha=.2,this.label.anchorOffsetX=this.label.width/2,this.label.anchorOffsetY=this.label.height/2,this.compornent.addChild(this.label)},e.prototype.addDestroyMethod=function(){this.compornent&&this.compornent.removeChildren(),this.label=null,this.text=null},e.prototype.updateContent=function(){},e}(UICompornent);__reflect(EffectLabel.prototype,"EffectLabel");var Sdk=function(){function t(){}return t.loadSdk=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n;return __generator(this,function(o){switch(o.label){case 0:return console.log("============================================================"),console.log("Liberapp.loadSdk:"),this.env=this.detectMode(location.origin),console.log("env: ",this.env),t=this.resolveSdkUrl(this.sdkPath),console.log("srcUrl: ",t),[4,this.loadScript(t)];case 1:return e=o.sent(),console.log("script:",e),n=window.LiberappSdk,"egret-wing"!==this.env?[3,3]:(console.log("with debugOptions",this.debugOptions),[4,n.enableDebug(this.debugOptions)]);case 2:o.sent(),o.label=3;case 3:return console.log("liberappSdk:",n),[2,n]}})})},t.detectMode=function(t){return/^https:\/\/(.+)\.a\.liberapp\.net$/.test(t)?"production":/^https:\/\/(.+)\.a\.staging.\.liberapp\.net$/.test(t)?"staging":/^https:\/\/(.+)\.a\.development\.liberapp\.net$/.test(t)?"development":"egret-wing"},t.resolveSdkUrl=function(t){var e=this.baseUrls[this.env];return""+e+t},t.loadScript=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){var o=document.createElement("script");o.async=!1,o.src=t,o.onload=function(){e(o)},o.onerror=function(){return n(new Error("Can not load script: src:"+t))},document.head.append(o)})]})})},t.baseUrls={production:"https://liberapp.net",staging:"https://staging.liberapp.net",development:"https://localhost","egret-wing":"https://staging.liberapp.net"},t.debugOptions={applicationKey:"2a2ef67d-0d5a-41e4-8307-69b67f0f552b",debugSigninOptions:{accessToken:"ee0d312e-a601-4d04-a948-2cb2bd456abd",userAkey:"f01d616b-f0bc-4ab0-80e1-04e10888ee3d"}},t.sdkPath="/dist/sdk/liberapp-ja-0_9.js",t}();__reflect(Sdk.prototype,"Sdk");var Social=function(){function t(){}return t.init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,o,r,i,s,a,h;return __generator(this,function(l){switch(l.label){case 0:return[4,Sdk.loadSdk()];case 1:return t=l.sent(),this.sdk=t,Toast.show({text:"ログイン中・・・",delay:3e4,canHide:!0}),[4,t.initializeAsync()];case 2:return l.sent(),[4,t.startGameAsync()];case 3:return l.sent(),Toast.show({text:this.playerName+"さんようこそ！",delay:3e3}),e=this,[4,t.getLeaderboardAsync("default")];case 4:return e.leaderboard=l.sent(),[4,Promise.all([this.leaderboard.getEntryCountAsync(),this.leaderboard.getEntriesAsync(3,0),this.leaderboard.getPlayerEntryAsync()])];case 5:return n=l.sent(),o=n[0],r=n[1],i=n[2],this.myBest=i,this.hasBest?Toast.show({text:"今のところ"+o+"人中"+this.bestRank+"位です",delay:3e3}):(s=r[0],a=s.getPlayer().getName(),h=s.getScore(),s&&Toast.show({text:o+"人が遊んでいます!\n一番は"+a+"さん\nスコアは"+h+"です",delay:3e3})),[2]}})})},Object.defineProperty(t,"hasBest",{get:function(){return!!this.myBest},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bestScore",{get:function(){return this.hasBest?this.myBest.getScore():0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bestRank",{get:function(){return this.myBest.getRank()},enumerable:!0,configurable:!0}),t.setScore=function(t){var e=this;setTimeout(function(){return __awaiter(e,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return Toast.show({text:"ハイスコアを送信中",delay:3e4,canHide:!0}),e=this,[4,this.leaderboard.setScoreAsync(t)];case 1:return e.myBest=n.sent(),Toast.show({text:"順位は"+this.bestRank+"位でした",delay:3e3}),[2]}})})},1)},Object.defineProperty(t,"playerName",{get:function(){return this.sdk.player.getName()||"名無し"},enumerable:!0,configurable:!0}),t}();__reflect(Social.prototype,"Social");var Util=function(){function t(){}return t.init=function(t){this.height=t.stage.stageHeight,this.width=t.stage.stageWidth,this.ui=t},t.random=function(t,e){return t+Math.random()*(e-t)},t.randomInt=function(t,e){return Math.floor(t+Math.random()*(e+.999-t))},t.clamp=function(t,e,n){return e>t&&(t=e),t>n&&(t=n),t},t.color=function(t,e,n){var o=t.toFixed(0),r=e.toFixed(0),i=n.toFixed(0);o=t.toString(16),r=e.toString(16),i=n.toString(16),o=("00"+o).slice(-2),r=("00"+r).slice(-2),i=("00"+i).slice(-2);var s=parseInt("0x"+o+r+i,16);return s},t.myText=function(t,e,n,o,r,i,s){var a=new eui.Label;return a.scaleX=r,a.scaleY=r,a.bold=s,a.size=o,a.text=n,a.textColor=i,a.x=t,a.y=e,a.multiline=!0,a},t.myStrokeText=function(t,e,n,o,r,i,s,a,h){var l=new eui.Label;return l.x=t,l.y=e,l.scaleX=r,l.scaleY=r,l.textFlow=[{text:n,style:{textColor:i,size:o,fontFamily:s,strokeColor:a,stroke:h}}],l},t.setRect=function(t,e,n,o,r,i,s,a){var h=new egret.Shape;return h.x=t,h.y=e,s?(h.graphics.beginFill(r),h.graphics.drawRoundRect(0,0,n,o,i),h.graphics.endFill()):(h.graphics.lineStyle(a,r),h.graphics.drawRoundRect(0,0,n,o,i)),h},t.setCircle=function(t,e,n,o,r,i){var s=new egret.Shape;return s.x=t,s.y=e,r?(s.graphics.beginFill(o),s.graphics.drawCircle(0,0,n),s.graphics.endFill()):(s.graphics.lineStyle(i,o),s.graphics.drawCircle(0,0,n)),s},t.setEllipse=function(t,e,n,o,r,i,s){var a=new egret.Shape;return a.x=t,a.y=e,i?(a.graphics.beginFill(r),a.graphics.drawEllipse(0,0,n,o),a.graphics.endFill()):(a.graphics.lineStyle(s,r),a.graphics.drawEllipse(0,0,n,o)),a},t.setLine=function(t,e,n,o,r,i){var s=(360-o)*Math.PI/180,a=new egret.Shape;return a.x=t,a.y=e,a.graphics.lineStyle(r,i),a.graphics.moveTo(t,e),a.graphics.lineTo(n*Math.cos(s),n*Math.sin(s)),a},t.remove=function(t,e){t&&e&&t.removeChild(e),e=null},t.toRadian=function(t){var e=t*Math.PI/180;return e%=2*Math.PI,0>e&&(e+=2*Math.PI),e},t.toDegree=function(t){var e=t/(Math.PI/180);return e%=360,0>e&&(e+=360),e},t.vector=function(t,e,n,o){var r=e*Math.PI/180,i=[];return void 0==n&&void 0==o?(i[0]=t*Math.cos(r),i[1]=t*Math.sin(r)):(i[0]=t*Math.cos(r)-n,i[1]=t*Math.sin(r)-o),i[2]=t,i},t.cross=function(t,e){var n=t[0]*e[1]-t[1]*e[0];return n},t.dot=function(t,e){var n=t[0]*e[0]+t[1]*e[1];return n},t.cos=function(e,n){var o=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),r=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));0>o&&(o*=-1),0>r&&(r*=-1);var i=t.dot(e,n)/(o*r);return i},t.sin=function(e,n){var o=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),r=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));0>o&&(o*=-1),0>r&&(r*=-1);var i=t.cross(e,n)/(o*r);return i},t.size=function(t){var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return e},t}();__reflect(Util.prototype,"Util");var Button=function(t){function e(e,n,o,r,i){var s=t.call(this,e,n,o,r)||this;return s.indexText=null,s.indexTextColor=ColorPallet.WHITE,s.shapeColor=ColorPallet.BLACK,s.mask=null,s.maskColor=ColorPallet.WHITE,s.onMask=!1,s.setCompornentStatus(e,n,o,r),s}return __extends(e,t),e.prototype.setCompornentStatus=function(t,e,n,o){this.compornent.touchEnabled=!0,this.compornent.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.tap,this)},e.prototype.setShape=function(t,e,n,o,r){r&&(this.shapeColor=r),this.shapes[0]=Util.setRect(t,e,n,o,this.shapeColor,70,!0),this.compornent.addChild(this.shapes[0])},e.prototype.setMask=function(t,e,n,o,r){r&&(this.maskColor=r),this.mask=Util.setRect(t,e,n,o,this.maskColor,70,!0),this.mask.alpha=0,this.shapes[1]=this.mask,this.compornent.addChild(this.mask)},e.prototype.setIndexText=function(t,e,n,o,r,i,s){this.indexText=Util.myText(t,e,s,r,i,this.indexTextColor,!0),this.indexText.anchorOffsetX=this.indexText.width/2,this.indexText.anchorOffsetY=this.indexText.height/2,this.indexText.x+=this.compornent.width/2,this.indexText.y+=this.compornent.height/2,this.indexText.textAlign=egret.HorizontalAlign.CENTER,this.indexText.verticalAlign=egret.VerticalAlign.MIDDLE,this.compornent.addChild(this.indexText)},e.prototype.addDestroyMethod=function(){this.compornent.hasEventListener&&this.compornent.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.tap,this),this.indexText&&(this.compornent.removeChild(this.indexText),this.indexText=null)},e}(UICompornent);__reflect(Button.prototype,"Button");var RetryButton=function(t){function e(e,n,o,r,i,s,a){var h=t.call(this,e,n,o,r,a)||this;return h.setShape(0,0,o,r),h.setIndexText(0,0,o,r,i,s,a),h.setMask(e,n,o,r),h}return __extends(e,t),e.prototype.tap=function(){GameOver.tap()},e.prototype.updateContent=function(){},e}(Button);__reflect(RetryButton.prototype,"RetryButton");var Description=function(t){function e(n,o,r,i,s){var a=t.call(this,n,o,r,i)||this;return a.text=null,a.textColor=0,e.I=a,a.textColor=s,a.setText(),MyTween.textFlash(a.text),a}return __extends(e,t),e.prototype.setText=function(){var t="色の違うパネルをタップ";this.text=Util.myText(Game.width/2,.15*Game.height,t,90,.5,this.textColor,!0),this.text.anchorOffsetX=this.text.width/2,this.text.anchorOffsetY=this.text.height/2,this.text.textAlign=egret.HorizontalAlign.CENTER,this.compornent.addChild(this.text)},e.prototype.addDestroyMethod=function(){this.compornent&&this.compornent.removeChildren(),egret.Tween.removeTweens(this.text),this.text=null},e.prototype.updateContent=function(){},e.I=null,e}(UICompornent);__reflect(Description.prototype,"Description");var GameStage=function(t){function e(){var n=t.call(this)||this;return n.setContainer(),e.index=GameObject.display.getChildIndex(e.display),n}return __extends(e,t),e.prototype.setContainer=function(){e.display=new egret.DisplayObjectContainer,GameObject.display.addChild(e.display)},e.prototype.addDestroyMethod=function(){e.display&&(e.display.removeChildren(),GameObject.display.removeChild(e.display),e.display=null)},e.prototype.updateContent=function(){},e.display=null,e}(GameObject);__reflect(GameStage.prototype,"GameStage");var Score=function(t){function e(n,o,r,i,s){var a=t.call(this,n,o,r,i)||this;return a.text=null,a.textBest=null,a.textColor=0,e.I=a,e.score=0,e.bestScore=0,e.combo=0,e.comboFlag=!1,a.textColor=s,e.bestScore=Social.bestScore,a.setText(),a}return __extends(e,t),e.prototype.setText=function(){this.text=Util.myText(0,0,"SCORE:"+e.score.toFixed(),80,.5,this.textColor,!0),this.compornent.addChild(this.text),this.textBest=Util.myText(0,this.text.y+50,"BEST:"+e.bestScore.toString(),80,.5,this.textColor,!0),e.bestScore=0,this.textBest.text="BEST: -/-位",this.compornent.addChild(this.textBest)},e.prototype.addDestroyMethod=function(){this.compornent&&(this.compornent.removeChildren(),this.compornent=null),this.text=null,this.textBest=null,e.score=0},e.prototype.gameOver=function(){e.score<=e.bestScore||(e.bestScore=e.score,this.updateContent(),Social.setScore(e.bestScore))},e.prototype.updateContent=function(){Social.hasBest?(e.bestScore=Social.bestScore,this.textBest.text="BEST: "+e.bestScore+"/"+Social.bestRank+"位"):(e.bestScore=0,this.textBest.text="BEST: -/-位"),e.bestScore<e.score},e.addScore=function(){e.score+=1,e.comboFlag?(this.score+=this.combo,this.combo++):(e.comboFlag=!0,this.combo=1)},e.miss=function(){e.comboFlag=!1,this.combo=0},e.I=null,e.score=0,e.bestScore=0,e.combo=0,e.comboFlag=!1,e}(UICompornent);__reflect(Score.prototype,"Score");var DefaultToastOptions={text:"",delay:3e3,canHide:!1},Toast=function(t){function e(e){var n=t.call(this,0,0,0,0)||this;return n.queue=[],n.rect=new eui.Rect,n.rect.alpha=0,n.label=new eui.Label,n.label.maxWidth=e,n.rect.addEventListener(eui.UIEvent.CREATION_COMPLETE,n.onRectCreationComplete,n),n.label.addEventListener(eui.UIEvent.RESIZE,n.onLabelResized,n),n.compornent.addChild(n.rect),n}return __extends(e,t),e.show=function(t){var n=__assign({},DefaultToastOptions,t);this.I||(this.I=new e(.6*Main.I.stage.width)),this.I.show(n)},e.destory=function(){var t=this.I;this.I=void 0,t&&(t.rect.removeChildren(),t.compornent.removeChildren(),t.rect=void 0,t.label=void 0)},e.prototype.show=function(t){if(console.log("Toast.show"),this.currentOptions){if(!this.currentOptions.canHide)return void this.queue.push(t);this.currentTween.setPaused(!0),this.currentTween=void 0,this.currentOptions=void 0,this.queue=[]}this.currentOptions=t,this.toastText=t.text,this.currentTween=egret.Tween.get(this.rect),this.currentTween.to({alpha:1},300).wait(t.delay).call(this.onStartHide,this)},e.prototype.onStartHide=function(){console.log("Toast.onStartHide"),void 0!==this.currentTween&&(this.currentTween=egret.Tween.get(this.rect),this.currentTween.to({alpha:0},300).call(this.onCompleteHide,this))},e.prototype.onCompleteHide=function(){if(console.log("Toast.onCompleteHide"),this.currentTween=void 0,this.currentOptions=void 0,0!==this.queue.length){var t=this.queue.shift();this.show(t)}},e.prototype.onRectCreationComplete=function(){console.log("Toast.onRectCreationComplete"),this.rect.fillColor=0,this.rect.fillAlpha=.6,this.rect.horizontalCenter=0,this.rect.verticalCenter=0,this.rect.ellipseWidth=30,this.rect.ellipseHeight=30,this.label.x=20,this.label.y=20,this.label.size=28,this.rect.addChild(this.label),this.toastText=""},Object.defineProperty(e.prototype,"toastText",{set:function(t){console.log("Toast.toastText:"),this.label.text=t},enumerable:!0,configurable:!0}),e.prototype.onLabelResized=function(){console.log("Toast.onLabelResized:"),this.rect.width=this.label.width+40,this.rect.height=this.label.height+40,this.rect.x=(Main.I.width-this.rect.width)/2,this.rect.y=(Main.I.height-this.rect.height)/2},e.prototype.updateContent=function(){},e}(UICompornent);__reflect(Toast.prototype,"Toast");var UILayer=function(){function t(){t.I=this,this.setContainer(),t.index=GameObject.display.getChildIndex(t.display)}return t.prototype.setContainer=function(){t.display=new egret.DisplayObjectContainer,t.display.width=0,t.display.height=0,GameObject.display.addChild(t.display)},t.prototype.remove=function(){t.display&&(t.display.removeChildren(),GameObject.display.removeChild(t.display),t.display=null)},t.I=null,t.display=null,t}();__reflect(UILayer.prototype,"UILayer");